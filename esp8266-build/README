Creating FROM image
===================

There is no longer any need to create a "from" image.  There is now a standard ubuntu:18.04 manifest which contains amd64 and arm images.  Hence a single Dockerfile covers these multiple artchitecture systems.  I build images for:

- amd64
- arm (rpi)

Creating individual build image
==============================

Edit the VERSION file to contain the SDK version.

On a machine with the required architecture run:

  docker build -t piersfinlayson/esp8266-build-<architecture>:VERSION .

<architecture> should be one of:
- amd64
- arm

Tag the image:

  docker tag piersfinlayson/esp8266-build-<architecture>:VERSION piersfinlayson/esp8266-build-<architecture>:latest

Once created push the image to dockerhub:

  docker push piersfinlayson/esp8266-build-<architecture>:latest
  docker push piersfinlayson/esp8266-build-<architecture>:<VERSION>

Creating architecture independent build image
=============================================

Once both architecture build images have been created, create an architecture independent manifest:

  docker push piersfinlayson/esp8266-build-amd64:latest
  docker push piersfinlayson/esp8266-build-arm:latest
  docker push piersfinlayson/esp8266-build-amd64:<VERSION>
  docker push piersfinlayson/esp8266-build-arm:<VERSION>

(Need to check following bit works!)

  docker manifest create piersfinlayson/esp8266-build:latest piersfinlayson/esp8266-build-amd64:latest piersfinlayson/esp8266-build-amd64:latest
  docker manifest annotate piersfinlayson/esp8266-build:latest piersfinlayson/esp8266-build-amd64:latest --arch amd64 --os linux
  docker manifest annotate piersfinlayson/esp8266-build:latest piersfinlayson/esp8266-build-arm:latest --arch arm --os linux
  docker manifest create piersfinlayson/esp8266-build:<VERSION> piersfinlayson/esp8266-build-amd64:<VERSION> piersfinlayson/esp8266-build-arm:<VERSION>
  docker manifest annotate piersfinlayson/esp8266-build:<VERSION> piersfinlayson/esp8266-build-amd64:<VERSION> --arch amd64 --os linux
  docker manifest annotate piersfinlayson/esp8266-build:<VERSION> piersfinlayson/esp8266-build-arm:<VERSION> --arch arm --os linux

